<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>QR Men√º</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #f0f0f0; margin: 0; padding: 0; }
    header { display: flex; justify-content: space-between; align-items: center; background: #222; color: white; padding: 15px 20px; }
    .menu-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 20px; padding: 30px; }
    .menu-item { background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); text-align: center; }
    .menu-item img { max-width: 60px; cursor: pointer; }
    button { margin: 5px; padding: 5px 10px; }
    input[type="text"], input[type="password"] { padding: 8px; margin-top: 10px; width: 100%; max-width: 300px; }
    .eye-icon { position: absolute; margin-left: -30px; cursor: pointer; }
    #login-section, #add-menu-section, #change-password-section, #disable-password-section { display: none; padding: 20px; }
  </style>
</head>
<body>

<header>
  <h2>QR Men√º</h2>
  <div>
    <button onclick="showLogin()">Giri≈ü Yap</button>
    <button onclick="showChangePassword()">≈ûifre Deƒüi≈ütir</button>
    <button onclick="showDisablePassword()">≈ûifreyi Kaldƒ±r</button>
  </div>
</header>

<div class="menu-grid" id="menu-container"></div>

<div id="login-section">
  <input type="password" id="password-input" placeholder="≈ûifre girin" />
  <span class="eye-icon" onclick="togglePassword()">üëÅÔ∏è</span><br/>
  <button onclick="checkPassword()">Giri≈ü</button>
</div>

<div id="add-menu-section">
  <input type="text" id="menu-name" placeholder="Men√º Adƒ±" /><br/>
  <input type="text" id="menu-url" placeholder="Y√∂nlendirme URL'si" /><br/>
  <input type="text" id="menu-image-url" placeholder="Logo (Resim URL)" /><br/>
  <button onclick="addNewMenu()">Men√ºye Ekle</button>
</div>

<div id="change-password-section">
  <input type="password" id="old-password" placeholder="Eski ≈ûifre" /><br/>
  <input type="password" id="new-password" placeholder="Yeni ≈ûifre" /><br/>
  <button onclick="changePassword()">≈ûifreyi Deƒüi≈ütir</button>
</div>

<div id="disable-password-section">
  <input type="password" id="verify-password" placeholder="≈ûifre girin (kaldƒ±rmak i√ßin)" /><br/>
  <button onclick="disablePassword()">≈ûifreyi Kaldƒ±r</button>
</div>

<script>
  let currentPassword = "1234567890";
  let passwordDisabled = false;

  const firebaseConfig = {
    apiKey: "AIzaSyAKc8xYsvoewvJFp8ms26uEFLnuclY3xr0",
    authDomain: "menubin-9f225.firebaseapp.com",
    databaseURL: "https://menubin-9f225-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "menubin-9f225",
    storageBucket: "menubin-9f225.appspot.com",
    messagingSenderId: "590812327239",
    appId: "1:590812327239:web:e9a17620b0d524b37af062"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  function showLogin() {
    document.getElementById("login-section").style.display = "block";
  }

  function togglePassword() {
    const input = document.getElementById("password-input");
    input.type = input.type === "password" ? "text" : "password";
  }

  function checkPassword() {
    const val = document.getElementById("password-input").value;
    if (passwordDisabled || val === currentPassword) {
      document.getElementById("add-menu-section").style.display = "block";
    } else {
      alert("Hatalƒ± ≈üifre!");
    }
  }

  function showChangePassword() {
    document.getElementById("change-password-section").style.display = "block";
  }

  function changePassword() {
    const oldP = document.getElementById("old-password").value;
    const newP = document.getElementById("new-password").value;
    if (oldP === currentPassword && newP.length > 0) {
      currentPassword = newP;
      alert("≈ûifre deƒüi≈ütirildi.");
    } else {
      alert("Eski ≈üifre yanlƒ±≈ü veya yeni ≈üifre bo≈ü.");
    }
  }

  function showDisablePassword() {
    document.getElementById("disable-password-section").style.display = "block";
  }

  function disablePassword() {
    const check = document.getElementById("verify-password").value;
    if (check === currentPassword) {
      passwordDisabled = true;
      alert("≈ûifre kaldƒ±rƒ±ldƒ±.");
    } else {
      alert("≈ûifre yanlƒ±≈ü.");
    }
  }

  function addNewMenu() {
    const name = document.getElementById("menu-name").value;
    const url = document.getElementById("menu-url").value;
    const img = document.getElementById("menu-image-url").value;
    if (!name || !url || !img) {
      alert("T√ºm alanlarƒ± doldurun.");
      return;
    }
    const item = { name, url, img };
    const key = db.ref().child("menus").push().key;
    db.ref("menus/" + key).set(item);
    location.reload();
  }

  function editMenu(key, item) {
    const name = prompt("Yeni isim:", item.name);
    const url = prompt("Yeni URL:", item.url);
    const img = prompt("Yeni g√∂rsel URL:", item.img);
    if (name && url && img) {
      db.ref("menus/" + key).set({ name, url, img });
      location.reload();
    }
  }

  function deleteMenu(key) {
    if (confirm("Bu men√ºy√º silmek istediƒüinizden emin misiniz?")) {
      db.ref("menus/" + key).remove();
      location.reload();
    }
  }

  function loadMenus() {
    db.ref("menus").once("value", (snapshot) => {
      const container = document.getElementById("menu-container");
      container.innerHTML = "";
      const data = snapshot.val();
      for (let key in data) {
        const item = data[key];
        const div = document.createElement("div");
        div.className = "menu-item";

        const img = document.createElement("img");
        img.src = item.img;
        img.alt = item.name;
        img.onclick = () => window.location.href = item.url;

        const title = document.createElement("div");
        title.innerText = item.name;

        const editBtn = document.createElement("button");
        editBtn.innerText = "D√ºzenle";
        editBtn.onclick = (e) => {
          e.stopPropagation();
          editMenu(key, item);
        };

        const deleteBtn = document.createElement("button");
        deleteBtn.innerText = "Sil";
        deleteBtn.onclick = (e) => {
          e.stopPropagation();
          deleteMenu(key);
        };

        div.appendChild(img);
        div.appendChild(title);
        div.appendChild(editBtn);
        div.appendChild(deleteBtn);
        container.appendChild(div);
      }
    });
  }

  window.onload = loadMenus;
</script>

</body>
</html>
