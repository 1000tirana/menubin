<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Wordlike Editor</title>
<style>
  :root{
    --page-w:210mm;
    --page-h:297mm;
    --page-margin:20mm;
  }
  body{margin:0;font-family:sans-serif;background:#f4f6f8}
  header{position:sticky;top:0;background:#fff;padding:6px;border-bottom:1px solid #ddd}
  .toolbar{display:flex;flex-wrap:wrap;gap:6px}
  .btn,select,input[type=number],input[type=color]{
    padding:6px 8px;font-size:13px;border:1px solid #ddd;border-radius:6px;background:#fff;cursor:pointer
  }
  .page{background:#fff;width:var(--page-w);min-height:var(--page-h);margin:20px auto;padding:var(--page-margin);box-shadow:0 2px 6px rgba(0,0,0,.1)}
  #editor[contenteditable=true]{outline:none}
  @media print{
    header{display:none}
    .page{box-shadow:none;border:none;margin:0}
  }
</style>
<style id="print-style"></style>
</head>
<body>
<header>
  <div class="toolbar">
    <input id="fontInput" type="number" min="8" max="250" step="1" placeholder="px">
    <select id="fontsize">
      <option value="">—</option>
      <option value="12px">12</option>
      <option value="24px">24</option>
      <option value="48px">48</option>
      <option value="96px">96</option>
      <option value="160px">160</option>
      <option value="250px">250</option>
    </select>
    <button class="btn" id="btn-size-dec">A−</button>
    <button class="btn" id="btn-size-inc">A+</button>

    <select id="orientation">
      <option value="portrait">Portrait</option>
      <option value="landscape">Landscape</option>
    </select>

    <button class="btn" onclick="window.print()">Print</button>
  </div>
</header>

<div class="page">
  <div id="editor" contenteditable="true">
    <h1>Untitled Document</h1>
    <p>Start typing here...</p>
  </div>
</div>

<script>
const editor=document.getElementById('editor');
const sizeSelect=document.getElementById('fontsize');
const fontInput=document.getElementById('fontInput');
const MAX=250,MIN=8;

function getSelRange(){const s=window.getSelection();return s&&s.rangeCount?s.getRangeAt(0):null;}

function applyFontSize(px){
  const r=getSelRange();if(!r)return;
  const frag=r.cloneContents();
  const span=document.createElement('span');
  span.style.fontSize=px;
  span.appendChild(frag);
  r.deleteContents();r.insertNode(span);
}

function step(delta){
  const r=getSelRange();if(!r)return;
  let base=r.startContainer.nodeType===1?r.startContainer:r.startContainer.parentElement;
  let cur=parseInt(getComputedStyle(base).fontSize)||14;
  let next=Math.max(MIN,Math.min(MAX,cur+delta));
  applyFontSize(next+'px');
  fontInput.value=next; sizeSelect.value='';
}

fontInput.addEventListener('change',e=>{
  let v=parseInt(e.target.value);if(isNaN(v))return;
  v=Math.max(MIN,Math.min(MAX,v));
  applyFontSize(v+'px'); sizeSelect.value='';
});
sizeSelect.addEventListener('change',e=>{
  if(!e.target.value)return;
  applyFontSize(e.target.value);
  fontInput.value=parseInt(e.target.value);
});
document.getElementById('btn-size-inc').onclick=()=>step(2);
document.getElementById('btn-size-dec').onclick=()=>step(-2);

/* print orientation */
const orient=document.getElementById('orientation');
const printStyle=document.getElementById('print-style');
orient.addEventListener('change',()=>{
  printStyle.textContent=@page{size:A4 ${orient.value};};
});
</script>
</body>
</html>
